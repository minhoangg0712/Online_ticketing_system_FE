<div class="captcha-container">
      <div class="captcha-modal">
        <div class="captcha-header">
          <h3>X√°c th·ª±c b·∫°n l√† ng∆∞·ªùi th·∫≠t</h3>
          <p>Vui l√≤ng ho√†n th√†nh th·ª≠ th√°ch b√™n d∆∞·ªõi ƒë·ªÉ ti·∫øp t·ª•c mua v√©</p>
        </div>

        <div class="captcha-content">
          <!-- Image Selection Challenge -->
          <div *ngIf="currentChallenge.type === 'image'" class="image-challenge">
            <p class="challenge-question">{{ currentChallenge.question }}</p>
            <div class="image-grid">
              <div 
                *ngFor="let image of currentChallenge.images; let i = index"
                class="image-item"
                [class.selected]="selectedImages.includes(i)"
                (click)="toggleImageSelection(i)"
              >
                <img [src]="image" [alt]="'H√¨nh ·∫£nh ' + (i + 1)">
                <div class="selection-overlay" *ngIf="selectedImages.includes(i)">
                  <i class="checkmark">‚úì</i>
                </div>
              </div>
            </div>
          </div>

          <!-- Math Challenge -->
          <div *ngIf="currentChallenge.type === 'math'" class="math-challenge">
            <p class="challenge-question">{{ currentChallenge.question }}</p>
            <input 
              type="number" 
              [(ngModel)]="mathAnswer" 
              placeholder="Nh·∫≠p ƒë√°p √°n"
              class="math-input"
            >
          </div>

          <!-- Slider Challenge -->
          <div *ngIf="currentChallenge.type === 'slider'" class="slider-challenge">
            <p class="challenge-question">{{ currentChallenge.question }}</p>
            <div class="slider-container">
              <div class="slider-track">
                <div 
                  class="slider-piece" 
                  [style.left.px]="sliderPosition"
                  (mousedown)="startDrag($event)"
                  (touchstart)="startDrag($event)"
                >
                  <i class="slider-icon"></i>
                </div>
              </div>
              <div class="slider-target" [style.left.px]="targetPosition"></div>
            </div>
          </div>

          <!-- Loading State -->
          <div *ngIf="isVerifying" class="loading-state">
            <div class="spinner"></div>
            <p>ƒêang x√°c th·ª±c...</p>
          </div>

          <!-- Result Messages -->
          <div *ngIf="verificationResult" class="result-message">
            <div *ngIf="verificationResult === 'success'" class="success-message">
              <i class="success-icon">‚úì</i>
              <span>X√°c th·ª±c th√†nh c√¥ng!</span>
            </div>
            <div *ngIf="verificationResult === 'failed'" class="error-message">
              <i class="error-icon">‚úó</i>
              <span>X√°c th·ª±c th·∫•t b·∫°i. Vui l√≤ng th·ª≠ l·∫°i.</span>
            </div>
          </div>
        </div>

        <div class="captcha-footer">
          <button 
            class="refresh-btn" 
            (click)="refreshChallenge()"
            [disabled]="isVerifying"
          >
            üîÑ L√†m m·ªõi
          </button>
          <button 
            class="verify-btn" 
            (click)="verifyAnswer()"
            [disabled]="!canVerify() || isVerifying"
          >
            X√°c th·ª±c
          </button>
        </div>
      </div>
    </div>